---
title: 在AFNetworking源码简析_3
layout: post
tags: []
category: 三方源码
---
前面主要是网络通讯类的实现大体思路.
AFNetworking还帮我们处理了一件很麻烦的事情就是请求与响应的序列化.

## 请求的序列化

主要是构造request的过程, 这一步是在AFHTTPSessionManager里面实现的.

![请求序列化](https://raw.githubusercontent.com/HighmoreXu/BlogImage/master/images/%E8%AF%B7%E6%B1%82%E5%BA%8F%E5%88%97%E5%8C%96.png "请求序列化")

AFURLRequestSerialization 代表一个协议
遵循该协议的类必须提供一个方法, 即传入request和parameters,然后返回一个新的request.

默认的是AFHTTPRequestSerializer.

序列化主要处理以下四部分内容.

1. 查询的url参数

使用AFNetworking时传入的值是字典, 而最终这些字典要转换成字符串然后拼接到HTTP的对应部分.转换方式是对dictionary进行递归,再将字符数组用&连成整体,最后根据HTTP方法将字符串置于url尾部或者请求体中.

2. http的header

3. 设置请求的属性

4. 分块上传


## 响应的序列化