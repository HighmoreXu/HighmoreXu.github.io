---
title: MVC
layout: post
tags: []
category: iOS
---
## 前言

MVC大概是每个iOS程序猿入门开发iOS应用所接触到的第一个architecture. 其简单易用性让很多新手开发能迅速上手.
MVC也是后续很多架构的基础, 本篇文章就分析下其特点以及一直被诟病的地方.有问题欢迎指出.
文中代码例子都来自引用中Draveness文章, 感觉蛮清晰的, 就不自己特意写了.

## 新手用法

不知道别人是不是这样的,我最先开始iOS开发的时候是这么使用的.

模型(model): 对业务场景进行模型的抽象, 单纯的数据结构.

```
struct User {
    enum Gender: String {
        case male = "male"
        case female = "female"
    }
    let name: String
    let email: String
    let age: Int
    let gender: Gender
}
```

视图(view):  UIView及其相关子类来实现UI效果.

控制器(controller):
* 管理根视图的生命周期和应用生命周期(UIController自带了一个view, 且控制了整个view的生命周期:didload, appear...)
* 负责将视图的UIView对象添加到持有的根视图上
* 负责处理用户行为, 比如button点击及手势触发等
* 存储当前界面状态
* 作为UITableview以及其他容器视图的代理及数据源. (datasource, delegate)
* 负责HTTP请求的发起

刚开始开发iOS应用时, 对MVC的应用大致局限于此, 其弊端也比较明显.controller承担了太多的工作, 从而就产生了massive controller.

## 总体原则
我们搞那么多架构, 那么多设计模式是为了什么? - 为了偷懒!
程序猿怎么偷懒: 少写代码! 出bug了好调! 需求改了代码少动!

我们MVC究竟应该怎么写, 其指导原则就是如何更好的偷懒.

少写代码.
抛开其余技巧不谈, 要想做到少写代码就只有一条原则: Don't repeat yourself.能复用的代码尽量复用, 那写的代码自然就少了.
View层, 我们新手写法完全没有问题, 只要好好锤炼自己编码技巧, 完全可以复用. Github上各种酷炫的UI三方库就可以很方便给大家用.
Model层, 用来存储业务的数据, 如果做得好也可以很方便复用.
controller层可复用性就比较差了, 所以其实现里应该只写那种无法复用的代码, 而像我们之前那样把所有的工作都转嫁到controller无疑将复用最小化.

出了Bug好调.
说白了就是单个文件的代码要少! 每一层职能清晰! 低耦合!
像controller那样什么逻辑都放在里面, 耦合严重, 也只是写代码的时候爽快, 调bug的时候直接爽歪歪.

需求改了代码少动.
总体来说还是细化!

## Model

从新手写法的介绍可以看出, model大概是代码量最少的模块了.
model讲道理负责的是数据管理部分, 但是目前好像只是针对业务模型进行了一次抽象, 像数据获取, 存储等都在controller层了.这明显

大多数iOS应用都提取除了网络服务层(service),承担数据管理的工作.iOS常见的MVC架构模式便可以理解为MVCS的形式.从概念上来讲, service层是拆分了model的职能, 实际上是在为service减负.

iOS层的Service层大体有两种常见的组织方式: 命令式, 声明式.






## 引用

